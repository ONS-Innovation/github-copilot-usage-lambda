{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"GitHub Copilot Usage Lambda","text":""},{"location":"#overview","title":"Overview","text":"<p>This project contains a Python script to automatically update the GitHub Copilot dashboard's historic information for the Copilot dashboard within the Digital Landscape. This allows trend analysis into how Software Engineers are using Copilot within ONS over time.</p> <p>The Copilot dashboard can be found on the Copilot tab within the Digital Landscape.</p> <p>View the Digital Landscape's repository.</p>"},{"location":"#getting-started","title":"Getting Started","text":"<p>To setup and use the project, please refer to the README.</p>"},{"location":"#technical-documentation","title":"Technical Documentation","text":"<p>For information about the technical aspects of the Copilot Usage Lambda, please refer to the Technical Documentation.</p>"},{"location":"documentation/","title":"Documentation","text":"<p>This site uses MkDocs to build its documentation and GitHub Pages for hosting.</p>"},{"location":"documentation/#format","title":"Format","text":"<p>Documentation within this project follows the following pattern:</p> <ul> <li>A <code>README.md</code> for each component</li> <li>A <code>/docs</code> folder for the project</li> </ul> <p>Each <code>README.md</code> should contain:</p> <ul> <li>A description of what the component is/does</li> <li>A list of any prerequisites</li> <li>Setup instructions</li> <li>Execution instructions</li> <li>Deployment instructions</li> </ul> <p>The <code>/docs</code> folder should contain:</p> <ul> <li>A description of what the project is</li> <li>An overview of how the everything fits together in the project</li> <li>An explanation of the tech stack</li> <li>Details of the underlying dataset</li> </ul> <p>A majority of the information should reside within the <code>/docs</code> directory over the <code>README</code>. The <code>README</code>s in this project should be kept for concise instructions on how to use each component. Any detailed explanation should be kept within <code>/docs</code>.</p>"},{"location":"documentation/#getting-mkdocs-setup","title":"Getting MkDocs Setup","text":"<p>In order to build an MkDocs deployment or serve the documentation locally, we need to install MkDocs and its dependencies.</p> <ol> <li> <p>Navigate into the project's root directory.</p> </li> <li> <p>Install MkDocs and its dependencies.</p> </li> </ol> <pre><code>poetry install --only docs\n</code></pre> <ol> <li>You can now use MkDocs. To see a list of commands run the following:</li> </ol> <pre><code>mkdocs --help\n</code></pre>"},{"location":"documentation/#updating-mkdocs-deployment","title":"Updating MkDocs Deployment","text":""},{"location":"documentation/#github-action-to-deploy-documentation","title":"GitHub Action to Deploy Documentation","text":"<p>A GitHub Action is set up to automatically deploy the documentation to GitHub Pages whenever a commit is made to the <code>main</code> branch. This action is triggered by a push event to the <code>main</code> branch and runs the <code>mkdocs gh-deploy</code> command to build and deploy the documentation.</p>"},{"location":"documentation/#manual-deployment","title":"Manual Deployment","text":"<p>If changes are made within <code>/docs</code>, the GitHub Pages deployment will need to be updated. Assuming you have already installed MkDocs and Material for MkDocs, do the following:</p> <ol> <li> <p>Navigate to the project's root directory.</p> </li> <li> <p>Deploy the documentation to GitHub Pages.</p> </li> </ol> <pre><code>mkdocs gh-deploy\n</code></pre> <ol> <li>This will build the documentation and deploy it to the <code>gh-pages</code> branch of your repository. The documentation will be available at <code>https://ONS-Innovation.github.io/&lt;repository-name&gt;/</code>.</li> </ol> <p>Please Note: The <code>gh-deploy</code> command will overwrite the <code>gh-pages</code> branch and make the local changes available on GitHub Pages. Make sure that these changes are appropriate and have been reviewed before deployment.</p>"},{"location":"technical_documentation/configuration/","title":"Configuration","text":"<p>The Copilot lambda uses a local configuration file to manage its settings, located within <code>./config/config.json</code>.</p>"},{"location":"technical_documentation/configuration/#configjson","title":"<code>config.json</code>","text":"<p>The <code>config.json</code> file contains the following:</p> <pre><code>{\n  \"features\": {\n    \"show_log_locally\": false,\n    \"write_data_locally\": false\n  },\n}\n</code></pre>"},{"location":"technical_documentation/configuration/#features","title":"<code>features</code>","text":"<p>This section contains feature flags that control which of the tool's features are enabled or disabled.</p>"},{"location":"technical_documentation/configuration/#show_log_locally","title":"<code>show_log_locally</code>","text":"<p>If set to <code>true</code>, the tool will output logs to the terminal.</p> <p>When deploying to AWS, this should be set to <code>false</code> to avoid files being written to the local filesystem.</p>"},{"location":"technical_documentation/configuration/#write_data_locally","title":"<code>write_data_locally</code>","text":"<p>If set to <code>true</code>, the tool will skip writing to the appropriate AWS S3 bucket and instead write data for copilot teams, historic usage, and teams history to <code>local_data</code>.</p> <p>When debugging locally, you can set this to <code>true</code> to use the local configuration file. This is useful if you need to see the logs locally, without affecting the cloud deployment.</p>"},{"location":"technical_documentation/configuration/#example-during-local-testing","title":"Example During Local Testing","text":"<p>When testing locally, you might set the <code>config.json</code> file as follows:</p> <pre><code>{\n  \"features\": {\n    \"show_log_locally\": true,\n    \"write_data_locally\": true\n  },\n}\n</code></pre>"},{"location":"technical_documentation/configuration/#example-on-aws","title":"Example On AWS","text":"<p>When deploying to AWS, the <code>config.json</code> file should be set as follows:</p> <pre><code>{\n  \"features\": {\n    \"show_log_locally\": false,\n    \"write_data_locally\": false\n  },\n}\n</code></pre> <p>This configuration ensures that the tool does not log or write data locally.</p> <p>It is essential that <code>write_data_locally</code> is set to <code>false</code> when deploying to AWS.</p>"},{"location":"technical_documentation/overview/","title":"Overview","text":"<p>AWS Lambda Function which updates the GitHub Copilot dashboard's:</p> <ul> <li>Organisation-wide historic data</li> <li>Copilot teams</li> <li>Teams history</li> </ul>"},{"location":"technical_documentation/overview/#tech-stack-overview","title":"Tech Stack Overview","text":"<p>This project uses:</p> <ul> <li>Python</li> <li>AWS Lambda</li> <li>AWS S3</li> </ul>"},{"location":"technical_documentation/overview/#architecture-overview","title":"Architecture Overview","text":"<p>This project uses 2 major components:</p> <ul> <li>The Lambda Function</li> <li>The GitHub API Toolkit (stored in another repository - Repository Link)</li> </ul>"},{"location":"technical_documentation/overview/#the-lambda-function","title":"The Lambda Function","text":"<p>This component updates the Digital Landscape's Copilot dashboard data, stored within S3 buckets. The lambda imports the GitHub API Toolkit to get the API response containing the data, then adds any new data to the relevant S3 bucket.</p>"},{"location":"technical_documentation/overview/#the-github-api-toolkit","title":"The GitHub API Toolkit","text":"<p>This component is an imported library which is shared across multiple GitHub tools. The toolkit allows applications to make authenticated requests to the GitHub API. It is imported and used by both the dashboard and lambda function.</p>"},{"location":"technical_documentation/overview/#endpoint","title":"Endpoint","text":"<p>View docs for the Copilot usage data endpoint.</p>"},{"location":"technical_documentation/overview/#historic-usage-data","title":"Historic Usage Data","text":"<p>This section gathers data from AWS S3. The Copilot usage endpoints have a limitation where they only return the last 100 days worth of information. To get around this, the project has an AWS Lambda function which runs weekly and stores data within an S3 bucket.</p>"},{"location":"technical_documentation/overview/#copilot-teams-data","title":"Copilot Teams Data","text":"<p>This section gathers a list of teams within the organisation with Copilot data and updates the S3 bucket accordingly. This allows all relevant teams to be displayed within the dashboard.</p>"},{"location":"technical_documentation/team_usage/","title":"Copilot Team Usage","text":""},{"location":"technical_documentation/team_usage/#overview","title":"Overview","text":"<p>This section of the project leverages GitHub OAuth2 for user authentication, granting access to essential data.</p> <p>The tech stack and UI is the same as the Organization Usage.</p>"},{"location":"technical_documentation/team_usage/#requirements-for-team-copilot-usage","title":"Requirements for Team Copilot Usage","text":"<p>To retrieve data, a team must meet the following criteria:</p> <ul> <li>At least 5 members with active Copilot licenses.</li> <li>These 5 users must be active for a minimum of 1 day.</li> </ul>"},{"location":"technical_documentation/team_usage/#access","title":"Access","text":""},{"location":"technical_documentation/team_usage/#flow-session","title":"Flow &amp; Session","text":"<p>When on the team usage page, a <code>Login with GitHub</code> is displayed. Once clicked on, the user is taken to GitHub's authorisation page. The permissions read-only personal user data and read-only organizations and teams are required for this application. Clicking on the green <code>Authorize</code> button takes the user back to the application.</p>"},{"location":"technical_documentation/team_usage/#types-of-access","title":"Types of Access","text":""},{"location":"technical_documentation/team_usage/#regular-user","title":"Regular User","text":"<p>A user within ONSDigital. Upon authentication, the app identifies the teams they belong to and populates the UI selection accordingly. If the user is part of a qualifying team, they can view the data. Users not associated with any team cannot select teams.</p>"},{"location":"technical_documentation/team_usage/#admin-user","title":"Admin User","text":"<p>An enhanced regular user with the ability to view any team. This user belongs to a specific whitelisted team, enabling them to view metrics for any team that meets the Copilot usage data requirements.</p>"},{"location":"technical_documentation/team_usage/#metrics","title":"Metrics","text":""},{"location":"technical_documentation/team_usage/#team-history-metrics","title":"Team History Metrics","text":"<p>The team history metrics function retrieves historical usage data for each team identified with Copilot usage. This data includes detailed metrics about the team's activity over time. New data for a team is fetched only from the last captured date in the file.</p>"},{"location":"technical_documentation/team_usage/#functionality","title":"Functionality","text":"<ul> <li>Input: The function in addition to the GitHub Client takes a team name, organisation and the optional \"since\" as a query parameter as input.</li> <li>Process:</li> <li>Fetches historical data for the specified team using the GitHub API.</li> <li>If the since query parameter exist then fetch data only after the specified date.</li> <li>Filters and organizes the data into a structured format.</li> <li>Output: A JSON object containing the team's historical metrics, including:</li> <li>Team name</li> <li>Activity data</li> <li>Copilot usage statistics</li> </ul>"},{"location":"technical_documentation/team_usage/#usage","title":"Usage","text":"<p>The historical metrics are stored in an S3 bucket as a json file (<code>teams_history.json</code>).</p>"},{"location":"technical_documentation/team_usage/#example","title":"Example","text":"<p>For a team named <code>kehdev</code>, the historical metrics might include:</p> <pre><code>{\n  \"team\": {\n    \"name\": \"kehdev\",\n    \"slug\": \"kehdev\",\n    \"description\": \"Team responsible for CI/CD pipelines\",\n    \"url\": \"https://github.com/orgs/&lt;organisation&gt;/teams/kehdev\"\n  },\n  \"data\": [\n    {\n      \"date\": \"2025-07-01\",\n      \"active_members\": 10,\n      \"copilot_usage_hours\": 50\n    },\n    {\n      \"date\": \"2025-07-02\",\n      \"active_members\": 12,\n      \"copilot_usage_hours\": 60\n    }\n  ]\n}\n</code></pre>"}]}